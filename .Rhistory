res <- ca(as.matrix(t(pcaDfm)))
plot(res, what = c('none', 'active'))
wordWeights <- data.frame(res$rowcoord[,1:2])
wordWeights$Republican <- ifelse(wordWeights$Dim1 <0, wordWeights$Dim1, 0)
wordWeights$Democrat <- ifelse(wordWeights$Dim1 > 0, wordWeights$Dim1, 0)
wordWeights$Neg <- ifelse(wordWeights$Dim2 < 0, wordWeights$Dim2, 0)
wordWeights$Pos <- ifelse(wordWeights$Dim2 > 0, wordWeights$Dim2, 0)
wct <- data.frame(Republican=wordWeights$Republican , Democrat=wordWeights$Democrat)
rownames(wct) <- rownames(wordWeights)
wordcloud::comparison.cloud((as.matrix(wct)),title.size=1.5,
random.order=FALSE, rot.per=0, scale=c(1,3))
wct <- data.frame(Negative=wordWeights$Neg , Positive=wordWeights$Pos)
rownames(wct) <- rownames(wordWeights)
wordcloud::comparison.cloud((as.matrix(wct)),title.size=1.5,
random.order=FALSE, rot.per=0, scale=c(1,2))
############
# 1.  Simple comparison clouds
#
# The color and size of the word is determined by the difference in rates of occurrence across the
# two categories (see ?comparison.cloud)
############
# compare parties
presDebateMat <- dfm(presDebateCorpus2016seg, groups = 'party') %>%
removeFeatures(stopwords('english')) %>% trim(minCount = 5) %>% as.matrix
wordcloud::comparison.cloud(t(presDebateMat), title.size=1.3, random.order=FALSE, rot.per = 0, max.words = 100)
# democratic candidates
demCorpus <- subset(presDebateCorpus2016seg, tag %in% c('SANDERS', 'CLINTON', 'O\'MALLEY'))
demMat <- dfm(demCorpus, groups = 'tag') %>%
removeFeatures(c(stopwords('english'), extra)) %>% trim(minCount = 5) %>% as.matrix
wordcloud::comparison.cloud(t(demMat), title.size=1.3, random.order=FALSE, rot.per = 0, max.words = 200)
# republicans
repCorpus <- subset(presDebateCorpus2016seg, tag %in% c('TRUMP', 'RUBIO', 'CRUZ', 'BUSH'))
repMat <- dfm(repCorpus, groups = 'tag') %>%
removeFeatures(c(stopwords('english'), extra)) %>% trim(minCount = 5) %>% as.matrix
wordcloud::comparison.cloud(t(repMat), title.size=1.3, random.order=FALSE, rot.per = 0, max.words = 200)
wordcloud::comparison.cloud(t(repMat), title.size=1.3, random.order=FALSE, rot.per = 0, max.words = 200)
repCorpus <- subset(presDebateCorpus2016seg, tag %in% c('TRUMP', 'RUBIO', 'CRUZ', 'BUSH'))
repMat <- dfm(repCorpus, ngrams=c(1,2),groups = 'tag') %>%
removeFeatures(c(stopwords('english'), extra)) %>% trim(minCount = 5) %>% as.matrix
wordcloud::comparison.cloud(t(repMat), title.size=1.3, random.order=FALSE, rot.per = 0, max.words = 200)
# Trump v others
trumpFactor <- ifelse(docvars(repCorpus, 'tag') == 'TRUMP', 'TRUMP', 'OTHER')
docvars(repCorpus, 'trumpFactor') <- trumpFactor
repMat <- dfm(repCorpus, groups = 'trumpFactor') %>%
removeFeatures(c(stopwords('english'), extra)) %>% trim(minCount = 5) %>% as.matrix
wordcloud::comparison.cloud(t(repMat), title.size=1.3, random.order=FALSE, rot.per = 0, max.words = 200)
repDf <- cbind(speech = texts(repCorpus), docvars(repCorpus), stringsAsFactors = FALSE)
repDf <- filter(repDf, nchar(speech) > 30)
repDfm <- dfm(repDf$speech) %>% trim(minDoc=8) %>%
removeFeatures(c(stopwords('english'), extra))
repMat <- as.matrix(repDfm)
trueClass <- as.factor(repDf$trumpFactor)
dim(repMat)
length(trueClass)
table(trueClass)
eModelTrump <- cv.glmnet(repMat, y=trueClass,  family = 'binomial', alpha=0.04, type.measure='class', standardize=TRUE)
runApp('shinyHack')
runApp('shinyHack')
?barplot
runApp('shinyHack')
runApp('shinyHack')
runApp('shinyHack')
mainCorpus <- subset(presDebateCorpus2016seg, tag %in% c('SANDERS', 'CLINTON', 'TRUMP', 'RUBIO'))
mainCorpus <- subset(presDebateCorpus2016seg, tag %in% c('SANDERS', 'CLINTON', 'TRUMP', 'RUBIO'))
mainMat <- dfm(repCorpus, ngrams=c(1),groups = 'tag') %>%
removeFeatures(c(stopwords('english'), extra)) %>% trim(minCount = 5) %>% as.matrix
#wordcloud::comparison.cloud(t(repMat), title.size=1.3, random.order=FALSE, rot.per = 0, max.words = 200)
mainDf <- cbind(speech = texts(mainorpus), docvars(mainCorpus), stringsAsFactors = FALSE)
mainDf <- cbind(speech = texts(mainCorpus), docvars(mainCorpus), stringsAsFactors = FALSE)
mainDf <- filter(mainDf, nchar(speech) > 30)
mainMat <- dfm(repCorpus, ngrams=c(1),groups = 'tag') %>%
removeFeatures(c(stopwords('english'), extra)) %>% trim(minCount = 5) %>% as.matrix
trueClass <- as.factor(mainDf$tag)
dim(repMat)
length(trueClass)
mainMat <- dfm(mainCorpus, ngrams=c(1),groups = 'tag') %>%
removeFeatures(c(stopwords('english'), extra)) %>% trim(minCount = 5) %>% as.matrix
#wordcloud::comparison.cloud(t(repMat), title.size=1.3, random.order=FALSE, rot.per = 0, max.words = 200)
trueClass <- as.factor(mainDf$tag)
dim(repMat)
length(trueClass)
mainDf <- cbind(speech = texts(mainCorpus), docvars(mainCorpus), stringsAsFactors = FALSE)
mainCorpus <- subset(presDebateCorpus2016seg, tag %in% c('SANDERS', 'CLINTON', 'TRUMP', 'RUBIO'))
#remove very short utterances
mainDf <- cbind(speech = texts(mainCorpus), docvars(mainCorpus), stringsAsFactors = FALSE)
#mainDf <- filter(mainDf, nchar(speech) > 30)
mainMat <- dfm(mainCorpus, ngrams=c(1),groups = 'tag') %>%
removeFeatures(c(stopwords('english'), extra)) %>% trim(minCount = 5) %>% as.matrix
#wordcloud::comparison.cloud(t(repMat), title.size=1.3, random.order=FALSE, rot.per = 0, max.words = 200)
trueClass <- as.factor(mainDf$tag)
dim(repMat)
length(trueClass)
mainCorpus <- subset(presDebateCorpus2016seg, tag %in% c('SANDERS', 'CLINTON', 'TRUMP', 'RUBIO'))
#remove very short utterances
mainDf <- cbind(speech = texts(mainCorpus), docvars(mainCorpus), stringsAsFactors = FALSE)
#mainDf <- filter(mainDf, nchar(speech) > 30)
mainMat <- dfm(mainCorpus, ngrams=c(1),groups = 'tag') %>%
removeFeatures(c(stopwords('english'), extra)) %>% trim(minCount = 5) %>% as.matrix
#wordcloud::comparison.cloud(t(repMat), title.size=1.3, random.order=FALSE, rot.per = 0, max.words = 200)
trueClass <- as.factor(mainDf$tag)
dim(repMat)
length(trueClass)
mainDf <- cbind(speech = texts(mainCorpus), docvars(mainCorpus), stringsAsFactors = FALSE)
mainDf <- filter(mainDf, nchar(speech) > 50)
mainCorpus <- subset(presDebateCorpus2016seg, tag %in% c('SANDERS', 'CLINTON', 'TRUMP', 'RUBIO'))
#remove very short utterances
#mainDf <- cbind(speech = texts(mainCorpus), docvars(mainCorpus), stringsAsFactors = FALSE)
#mainDf <- filter(mainDf, nchar(speech) > 50)
mainMat <- dfm(mainCorpus, ngrams=c(1),groups = 'tag') %>%
removeFeatures(c(stopwords('english'), extra)) %>% trim(minCount = 5) %>% as.matrix
#wordcloud::comparison.cloud(t(repMat), title.size=1.3, random.order=FALSE, rot.per = 0, max.words = 200)
trueClass <- as.factor(mainDf$tag)
dim(repMat)
length(trueClass)
dim(mainMat)
mainCorpus <- subset(presDebateCorpus2016seg, tag %in% c('SANDERS', 'CLINTON', 'TRUMP', 'RUBIO'))
#remove very short utterances
mainDf <- cbind(speech = texts(mainCorpus), docvars(mainCorpus), stringsAsFactors = FALSE)
mainDf <- filter(mainDf, nchar(speech) > 50)
mainMat <- dfm(mainDf$speech, ngrams=c(1),groups = 'tag') %>%
removeFeatures(c(stopwords('english'), extra)) %>% trim(minCount = 5) %>% as.matrix
#wordcloud::comparison.cloud(t(repMat), title.size=1.3, random.order=FALSE, rot.per = 0, max.words = 200)
mainCorpus <- subset(presDebateCorpus2016seg, tag %in% c('SANDERS', 'CLINTON', 'TRUMP', 'RUBIO'))
#remove very short utterances
mainDf <- cbind(speech = texts(mainCorpus), docvars(mainCorpus), stringsAsFactors = FALSE)
mainDf <- filter(mainDf, nchar(speech) > 50)
mainMat <- dfm(mainDf$speech, ngrams=c(1)) %>%
removeFeatures(c(stopwords('english'), extra)) %>% trim(minCount = 5) %>% as.matrix
#wordcloud::comparison.cloud(t(repMat), title.size=1.3, random.order=FALSE, rot.per = 0, max.words = 200)
trueClass <- as.factor(mainDf$tag)
dim(mainMat)
length(trueClass)
table(trueClass)
eModelMain <- cv.glmnet(repMat, y=trueClass,  family = 'multinomial', alpha=0.04, type.measure='class', standardize=TRUE)
dim(mainMat)
length(trueClass)
eModelMain <- cv.glmnet(mainMat, y=trueClass,  family = 'multinomial', alpha=0.04, type.measure='class', standardize=TRUE)
plot(eModelMain)
nt <- "I have a tremendous brain. I know many of the finest businesses. "
nd1 <- dfm(nt, keptFeatures = mainDfm) %>% removeFeatures(c(stopwords('english'), extra)) %>% as.matrix
mainDfm <- dfm(mainDf$speech, ngrams=c(1)) %>%
removeFeatures(c(stopwords('english'), extra)) %>% trim(minCount = 5) %>% tfidf
mainMat <- as.matrix(mainDfm)
#wordcloud::comparison.cloud(t(repMat), title.size=1.3, random.order=FALSE, rot.per = 0, max.words = 200)
trueClass <- as.factor(mainDf$tag)
dim(mainMat)
length(trueClass)
table(trueClass)
eModelMain <- cv.glmnet(mainMat, y=trueClass,  family = 'multinomial', alpha=0.04, type.measure='class', standardize=TRUE)
plot(eModelMain)
min(eModelMain$cvm)
mainDfm <- dfm(mainDf$speech, ngrams=c(1)) %>%
removeFeatures(c(stopwords('english'), extra)) %>% trim(minCount = 5)
mainMat <- as.matrix(mainDfm)
#wordcloud::comparison.cloud(t(repMat), title.size=1.3, random.order=FALSE, rot.per = 0, max.words = 200)
trueClass <- as.factor(mainDf$tag)
dim(mainMat)
length(trueClass)
table(trueClass)
eModelMain <- cv.glmnet(mainMat, y=trueClass,  family = 'multinomial', alpha=0.04, type.measure='class', standardize=TRUE)
plot(eModelMain)
min(eModelMain$cvm)
nt <- "I have a tremendous brain. I know many of the finest businesses. "
nd1 <- dfm(nt, keptFeatures = mainDfm) %>% removeFeatures(c(stopwords('english'), extra)) %>% as.matrix
predict(eModelMain, nd1, s = "lambda.min", type = "response")
nt <- "Madam Secretary, Hilary, is a friend of wall street. Millionaires "
nd1 <- dfm(nt, keptFeatures = mainDfm) %>% removeFeatures(c(stopwords('english'), extra)) %>% as.matrix
predict(eModelMain, nd1, s = "lambda.min", type = "response")
nt <- "Donald is not a credible sensible candidate with values. "
#nt <- "I believe that American families have a right to hard-working immigrants. "
nd1 <- dfm(nt, keptFeatures = mainDfm) %>% removeFeatures(c(stopwords('english'), extra)) %>% as.matrix
nd1[is.nan(nd1)] = 0
predict(eModelMain, nd1, s = "lambda.min", type = "response")
nt <- "Donald is candidate. Obama knows what he is doing."
#nt <- "I believe that American families have a right to hard-working immigrants. "
nd1 <- dfm(nt, keptFeatures = mainDfm) %>% removeFeatures(c(stopwords('english'), extra)) %>% as.matrix
nd1[is.nan(nd1)] = 0
predict(eModelMain, nd1, s = "lambda.min", type = "response")
mainDfm <- dfm(mainDf$speech, ngrams=c(1,2)) %>%
removeFeatures(c(stopwords('english'), extra)) %>% trim(minCount = 5)
mainMat <- as.matrix(mainDfm)
#wordcloud::comparison.cloud(t(repMat), title.size=1.3, random.order=FALSE, rot.per = 0, max.words = 200)
trueClass <- as.factor(mainDf$tag)
dim(mainMat)
length(trueClass)
table(trueClass)
eModelMain <- cv.glmnet(mainMat, y=trueClass,  family = 'multinomial', alpha=0.04, type.measure='class', standardize=TRUE)
plot(eModelMain)
min(eModelMain$cvm)
nt <- "Donald is a candidate. Obama knows what he is doing."
#nt <- "I believe that American families have a right to hard-working immigrants. "
nd1 <- dfm(nt, keptFeatures = mainDfm, ngrams=c(1,2)) %>% removeFeatures(c(stopwords('english'), extra)) %>% as.matrix
nd1[is.nan(nd1)] = 0
predict(eModelMain, nd1, s = "lambda.min", type = "response")
nt <- " is a candidate. Obama knows what he is doing."
#nt <- "I believe that American families have a right to hard-working immigrants. "
nd1 <- dfm(nt, keptFeatures = mainDfm, ngrams=c(1,2)) %>% removeFeatures(c(stopwords('english'), extra)) %>% as.matrix
nd1[is.nan(nd1)] = 0
predict(eModelMain, nd1, s = "lambda.min", type = "response")
nt <- " is a candidate. United states knows what he is doing."
#nt <- "I believe that American families have a right to hard-working immigrants. "
nd1 <- dfm(nt, keptFeatures = mainDfm, ngrams=c(1,2)) %>% removeFeatures(c(stopwords('english'), extra)) %>% as.matrix
nd1[is.nan(nd1)] = 0
predict(eModelMain, nd1, s = "lambda.min", type = "response")
nt <- "when I am president I will represent the people"
#nt <- "I believe that American families have a right to hard-working immigrants. "
nd1 <- dfm(nt, keptFeatures = mainDfm, ngrams=c(1,2)) %>% removeFeatures(c(stopwords('english'), extra)) %>% as.matrix
nd1[is.nan(nd1)] = 0
predict(eModelMain, nd1, s = "lambda.min", type = "response")
nt <- "A conservative movement committed to the cause of free enterprise, the only economic model where everyone can climb without anyone falling. "
#nt <- "I believe that American families have a right to hard-working immigrants. "
nd1 <- dfm(nt, keptFeatures = mainDfm, ngrams=c(1,2)) %>% removeFeatures(c(stopwords('english'), extra)) %>% as.matrix
nd1[is.nan(nd1)] = 0
predict(eModelMain, nd1, s = "lambda.min", type = "response")
predict(eModelMain, nd1, s = "lambda.min", type = "link")
runApp('shinyHack')
runApp('shinyHack')
?textInput
runApp('shinyHack')
runApp('shinyHack')
runApp('shinyHack')
runApp('shinyHack')
runApp('shinyHack')
runApp('shinyHack')
?pageWithSidebar
?sidebarPanel
runApp('shinyHack')
runApp('shinyHack')
?headerPanel
runApp('shinyHack')
runApp('shinyHack')
runApp('shinyHack')
runApp('shinyHack')
runApp('shinyHack')
?sidebarPanel
?textInput
runApp('shinyHack')
runApp('shinyHack')
cmat <- as.matrix(coef(eModelMain, s = "lambda.min"))
coes <- data.frame(estimate=cmat[,1], words=row.names(cmat) ) %>% arrange(estimate)
coes <- data.frame(estimate=cmat[,1], words=row.names(cmat) ) %>% arrange(estimate)
head(cmat)
trueClass <- as.factor(mainDf$party)
dim(mainMat)
length(trueClass)
table(trueClass)
eModelMain <- cv.glmnet(mainMat, y=trueClass,  family = 'multinomial', alpha=0.04, type.measure='class', standardize=TRUE)
plot(eModelMain)
min(eModelMain$cvm)
nt <- "A conservative movement committed to the cause of free enterprise, the only economic model where everyone can climb without anyone falling. "
#nt <- "I believe that American families have a right to hard-working immigrants. "
nd1 <- dfm(nt, keptFeatures = mainDfm, ngrams=c(1,2)) %>% removeFeatures(c(stopwords('english'), extra)) %>% as.matrix
nd1[is.nan(nd1)] = 0
predict(eModelMain, nd1, s = "lambda.min", type = "response")
mainCorpus <- subset(presDebateCorpus2016seg, tag %in% c('SANDERS', 'CLINTON', 'TRUMP', 'RUBIO'))
#remove very short utterances
mainDf <- cbind(speech = texts(mainCorpus), docvars(mainCorpus), stringsAsFactors = FALSE)
mainDf <- filter(mainDf, nchar(speech) > 50)
mainDfm <- dfm(mainDf$speech, ngrams=c(1,2)) %>%
removeFeatures(c(stopwords('english'), extra)) %>% trim(minCount = 5)
mainMat <- as.matrix(mainDfm)
#wordcloud::comparison.cloud(t(repMat), title.size=1.3, random.order=FALSE, rot.per = 0, max.words = 200)
trueClass <- as.factor(mainDf$tag)
dim(mainMat)
length(trueClass)
table(trueClass)
eModelMain <- cv.glmnet(mainMat, y=trueClass,  family = 'multinomial', alpha=0.04, type.measure='class', standardize=TRUE)
plot(eModelMain)
min(eModelMain$cvm)
nt <- "A conservative movement committed to the cause of free enterprise, the only economic model where everyone can climb without anyone falling. "
#nt <- "I believe that American families have a right to hard-working immigrants. "
nd1 <- dfm(nt, keptFeatures = mainDfm, ngrams=c(1,2)) %>% removeFeatures(c(stopwords('english'), extra)) %>% as.matrix
nd1[is.nan(nd1)] = 0
predict(eModelMain, nd1, s = "lambda.min", type = "response")
?as.factor
trueClass <- as.factor(mainDf$tag, levels = c('SANDERS', 'CLINTON', 'RUBIO', 'TRUMP'))
mainDf <- cbind(speech = texts(mainCorpus), docvars(mainCorpus), stringsAsFactors = FALSE)
mainDf <- filter(mainDf, nchar(speech) > 50)
mainDfm <- dfm(mainDf$speech, ngrams=c(1,2)) %>%
removeFeatures(c(stopwords('english'), extra)) %>% trim(minCount = 5)
mainMat <- as.matrix(mainDfm)
#wordcloud::comparison.cloud(t(repMat), title.size=1.3, random.order=FALSE, rot.per = 0, max.words = 200)
partyClass <- as.factor(mainDf$party)
dim(mainMat)
length(trueClass)
table(trueClass)
plot(eModelParty)
eModelParty <- cv.glmnet(mainMat, y=partyClass,  family = 'multinomial', alpha=0.04, type.measure='class', standardize=TRUE)
runApp('shinyHack')
runApp('shinyHack')
runApp('shinyHack')
runApp('shinyHack')
runApp('shinyHack')
runApp('shinyHack')
?barplot
runApp('shinyHack')
runApp('shinyHack')
runApp('shinyHack')
tmp <- predict(eModelMain, nd1, s = "lambda.min", type = "response")
tmp
colnames(tmp)
as.numeric(tmp)
runApp('shinyHack')
class(tmp)
tmp1 <- as.vector(tmp)
tmp1
names(tmp1)
tmp1 <- data.matrix(tmp)
tmp1
tmp1 <- as.matrix(tmp)
tmp1
tmp1 <- as.numeric(tmp)
tmp1
tmp
?as.numeric
names(tmp)
tmp
colnames(tmp)
tmp1 <- as.numeric(tmp, drop=FALSE)
tmp1
tmp1 <- as.vector(tmp, drop=FALSE)
tmp1 <- as.vector(tmp, drop=FALS)
tmp1 <- as.vector(tmp)
tmp1
?barplot
names(tmp)
colnames(tmp)
runApp('shinyHack')
runApp('shinyHack')
runApp('shinyHack')
?fluidRow
runApp('shinyHack')
runApp('shinyHack')
runApp('shinyHack')
runApp('shinyHack')
table(trueClass)
View(mainDf)
mainDf <- cbind(speech = texts(mainCorpus), docvars(mainCorpus), stringsAsFactors = FALSE)
mainDf <- filter(mainDf, nchar(speech) > 20)
table(mainDf$tag)
mainDf <- filter(mainDf, nchar(speech) > 100)
table(mainDf$tag)
mainDf <- filter(mainDf, nchar(speech) > 70)
mainDf <- cbind(speech = texts(mainCorpus), docvars(mainCorpus), stringsAsFactors = FALSE)
mainDf <- filter(mainDf, nchar(speech) > 70)
table(mainDf$tag)
mainDf <- cbind(speech = texts(mainCorpus), docvars(mainCorpus), stringsAsFactors = FALSE)
mainDf <- filter(mainDf, nchar(speech) > 70)
mainDfm <- dfm(mainDf$speech, ngrams=c(1,2)) %>%
removeFeatures(c(stopwords('english'), extra)) %>% trim(minCount = 5)
mainMat <- as.matrix(mainDfm)
partyClass <- as.factor(mainDf$party)
dim(mainMat)
length(trueClass)
table(trueClass)
eModelParty <- cv.glmnet(mainMat, y=partyClass,  family = 'multinomial', alpha=0.04, type.measure='class', standardize=TRUE)
plot(eModelParty)
min(eModelParty$cvm)
mainCorpus <- subset(presDebateCorpus2016seg, tag %in% c('SANDERS', 'CLINTON', 'TRUMP', 'RUBIO'))
#remove very short utterances
mainDf <- cbind(speech = texts(mainCorpus), docvars(mainCorpus), stringsAsFactors = FALSE)
mainDf <- filter(mainDf, nchar(speech) > 70)
mainDfm <- dfm(mainDf$speech, ngrams=c(1,2)) %>%
removeFeatures(c(stopwords('english'), extra)) %>% trim(minCount = 5)
mainMat <- as.matrix(mainDfm)
trueClass <- as.factor(mainDf$tag)
dim(mainMat)
length(trueClass)
table(trueClass)
eModelMain <- cv.glmnet(mainMat, y=trueClass,  family = 'multinomial', alpha=0.04, type.measure='class', standardize=TRUE)
plot(eModelMain)
min(eModelMain$cvm)
runApp('shinyHack')
?sample_n
runApp('shinyHack')
mainDf <- cbind(speech = texts(mainCorpus), docvars(mainCorpus), stringsAsFactors = FALSE)
mainDf <- filter(mainDf, nchar(speech) > 70)
table(mainDf$tag)
mainDf <- cbind(speech = texts(mainCorpus), docvars(mainCorpus), stringsAsFactors = FALSE)
mainDf <- filter(mainDf, nchar(speech) > 80)
table(mainDf$tag)
#remove very short utterances (cutting at 80 characters also gives roughly balanced classes.)
mainDf <- cbind(speech = texts(mainCorpus), docvars(mainCorpus), stringsAsFactors = FALSE)
mainDf <- filter(mainDf, nchar(speech) > 80)
table(mainDf$tag)
mainDfm <- dfm(mainDf$speech, ngrams=c(1,2)) %>%
removeFeatures(c(stopwords('english'), extra)) %>% trim(minCount = 5)
mainMat <- as.matrix(mainDfm)
partyClass <- as.factor(mainDf$party)
dim(mainMat)
length(trueClass)
table(trueClass)
eModelParty <- cv.glmnet(mainMat, y=partyClass,  family = 'multinomial', alpha=0.04, type.measure='class', standardize=TRUE)
plot(eModelParty)
min(eModelParty$cvm)
# predict new text
nt <- "A conservative movement committed to the cause of free enterprise, the only economic model where everyone can climb without anyone falling. "
#nt <- "I believe that American families have a right to hard-working immigrants. "
nd1 <- dfm(nt, keptFeatures = mainDfm, ngrams=c(1,2)) %>% removeFeatures(c(stopwords('english'), extra)) %>% as.matrix
mainCorpus <- subset(presDebateCorpus2016seg, tag %in% c('SANDERS', 'CLINTON', 'TRUMP', 'RUBIO'))
#remove very short utterances
mainDf <- cbind(speech = texts(mainCorpus), docvars(mainCorpus), stringsAsFactors = FALSE)
mainDf <- filter(mainDf, nchar(speech) > 80)
mainDfm <- dfm(mainDf$speech, ngrams=c(1,2)) %>%
removeFeatures(c(stopwords('english'), extra)) %>% trim(minCount = 5)
mainMat <- as.matrix(mainDfm)
trueClass <- as.factor(mainDf$tag)
dim(mainMat)
length(trueClass)
table(trueClass)
eModelMain <- cv.glmnet(mainMat, y=trueClass,  family = 'multinomial', alpha=0.04, type.measure='class', standardize=TRUE)
plot(eModelMain)
runApp('shinyHack')
?textInput
runApp('shinyHack')
runApp('shinyHack')
runApp('shinyHack')
runApp('shinyHack')
runApp('shinyHack')
runApp('shinyHack')
runApp('shinyHack')
runApp('shinyHack')
runApp('shinyHack')
runApp('shinyHack')
runApp('shinyHack')
runApp('shinyHack')
runApp('shinyHack')
runApp('shinyHack')
runApp('shinyHack')
runApp('shinyHack')
runApp('shinyHack')
runApp('shinyHack')
?comparison.cloud
require(wordcloud)
?comparison.cloud
mainCorpus <- subset(presDebateCorpus2016seg, tag %in% c('SANDERS', 'CLINTON', 'TRUMP', 'CRUZ'))
#remove very short utterances
mainDf <- cbind(speech = texts(mainCorpus), docvars(mainCorpus), stringsAsFactors = FALSE)
mainDf <- filter(mainDf, nchar(speech) > 80)
mainCorpus <- subset(presDebateCorpus2016seg, tag %in% c('SANDERS', 'CLINTON', 'TRUMP', 'CRUZ'))
summary(mainCorpus)
presDebateDf <- cbind(speech = texts(presDebateCorpus2016seg), docvars(presDebateCorpus2016seg), stringsAsFactors = FALSE)
cruzCorpus <- subset(presDebateCorpus2016seg, tag %in% c('SANDERS', 'CLINTON', 'TRUMP', 'CRUZ'))
mainCorpus <- subset(presDebateCorpus2016seg, tag %in% c('SANDERS', 'CLINTON', 'TRUMP', 'CRUZ'))
#remove very short utterances
mainDf <- cbind(speech = texts(mainCorpus), docvars(mainCorpus), stringsAsFactors = FALSE)
mainDf <- filter(mainDf, nchar(speech) > 80)
mainDfm <- dfm(mainDf$speech, ngrams=c(1,2)) %>%
presDebateDf <- cbind(speech = texts(presDebateCorpus2016seg), docvars(presDebateCorpus2016seg), stringsAsFactors = FALSE)
presDebateDf <- cbind(speech = texts(presDebateCorpus2016seg), docvars(presDebateCorpus2016seg), stringsAsFactors = FALSE)
require(magrittr)
require(dplyr)
require(tidyr)
require(wordcloud)
require(glmnet)
mainCorpus <- subset(presDebateCorpus2016seg, tag %in% c('SANDERS', 'CLINTON', 'TRUMP', 'CRUZ'))
#remove very short utterances
mainDf <- cbind(speech = texts(mainCorpus), docvars(mainCorpus), stringsAsFactors = FALSE)
mainDf <- filter(mainDf, nchar(speech) > 80)
mainDfm <- dfm(mainDf$speech, ngrams=c(1,2)) %>%
removeFeatures(c(stopwords('english'), extra)) %>% trim(minCount = 5)
mainMat <- as.matrix(mainDfm)
trueClass <- as.factor(mainDf$tag)
dim(mainMat)
length(trueClass)
table(trueClass)
eModelMain <- cv.glmnet(mainMat, y=trueClass,  family = 'multinomial', alpha=0.04, type.measure='class', standardize=TRUE)
plot(eModelMain)
min(eModelMain$cvm)
mainDf <- cbind(speech = texts(mainCorpus), docvars(mainCorpus), stringsAsFactors = FALSE)
mainDf <- filter(mainDf, nchar(speech) > 80)
table(mainDf$tag)
mainCorpus <- subset(presDebateCorpus2016seg, tag %in% c('SANDERS', 'CLINTON', 'TRUMP', 'RUBIO', 'CRUZ'))
#remove very short utterances
mainDf <- cbind(speech = texts(mainCorpus), docvars(mainCorpus), stringsAsFactors = FALSE)
mainDf <- filter(mainDf, nchar(speech) > 80)
mainDfm <- dfm(mainDf$speech, ngrams=c(1,2)) %>%
removeFeatures(c(stopwords('english'), extra)) %>% trim(minCount = 5)
mainMat <- as.matrix(mainDfm)
trueClass <- as.factor(mainDf$tag)
dim(mainMat)
length(trueClass)
table(trueClass)
eModelMain <- cv.glmnet(mainMat, y=trueClass,  family = 'multinomial', alpha=0.04, type.measure='class', standardize=TRUE)
plot(eModelMain)
min(eModelMain$cvm)
shiny::runApp('shinyHack')
mainDf <- cbind(speech = texts(mainCorpus), docvars(mainCorpus), stringsAsFactors = FALSE)
mainDf <- filter(mainDf, nchar(speech) > 80)
table(mainDf$tag)
mainDfm <- dfm(mainDf$speech, ngrams=c(1,2)) %>%
removeFeatures(c(stopwords('english'), extra)) %>% trim(minCount = 5)
mainMat <- as.matrix(mainDfm)
partyClass <- as.factor(mainDf$party)
dim(mainMat)
length(trueClass)
table(trueClass)
mainCorpus <- subset(presDebateCorpus2016seg, tag %in% c('SANDERS', 'CLINTON', 'TRUMP', 'RUBIO', 'CRUZ'))
#remove very short utterances
mainDf <- cbind(speech = texts(mainCorpus), docvars(mainCorpus), stringsAsFactors = FALSE)
mainDf <- filter(mainDf, nchar(speech) > 80)
mainDfm <- dfm(mainDf$speech, ngrams=c(1,2,3)) %>%
removeFeatures(c(stopwords('english'), extra)) %>% trim(minCount = 5)
mainMat <- as.matrix(mainDfm)
trueClass <- as.factor(mainDf$tag)
dim(mainMat)
length(trueClass)
table(trueClass)
eModelMain <- cv.glmnet(mainMat, y=trueClass,  family = 'multinomial', alpha=0.04, type.measure='class', standardize=TRUE)
plot(eModelMain)
min(eModelMain$cvm)
runApp('shinyHack')
